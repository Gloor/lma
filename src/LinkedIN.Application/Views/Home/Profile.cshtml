@model LinkedIN.Application.Model.Profile
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "LinkedIn Matrix Analyzer";

    List<string> comments_rows = new List<string>();
    List<string> likes_rows = new List<string>();
    for (int i = 0, j = 1; i < 12; i++, j = i + 1)
    {
        comments_rows.Add("[" + @j + ", " + @Model.comments[i] + "]");
        likes_rows.Add("[" + @j + ", " + @Model.likes[i] + "]");
    }
    var comments = "['Week', 'Comments']," + String.Join(",", comments_rows);
    var likes = "['Week', 'Likes']," + String.Join(",", likes_rows);
}
@section Scripts {
 <script type="text/javascript" src="https://www.google.com/jsapi"></script>
}
<script type="text/javascript">
  var comments_data, likes_data, options, chart_likes, chart_comments;
  google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    comments_data = google.visualization.arrayToDataTable([@Html.Raw(comments)]);
    likes_data = google.visualization.arrayToDataTable([@Html.Raw(likes)]);
    options = {
        title: "People liked you",
        fontSize: 12,
        titleTextStyle: {fontSize: 20, bold: true},
        hAxis: { title: 'Week', textStyle: {fontSize:10, bold: true} },
        colors: ["#0D2040"],
        legend: "none",
        vAxis: {maxValue: 11},
        width: '80%', height: 400,
        chartArea: {width: 400}
    };
    chart_likes = new google.visualization.ColumnChart(document.getElementById('chart_likes'));
    chart_likes.draw(likes_data, options);
    chart_comments = new google.visualization.ColumnChart(document.getElementById('chart_comments'));
    options['colors'] = ["#FD9C19"];
    options['title'] = "People talked to you";
    chart_comments.draw(comments_data, options);
  }
</script>
<div class="container">
  <div class="row-fluid well">
    <div class="span1">
      <img src="@Model.person.PictureUrl" />
    </div>
    <div class="span5">
      <h1 class="pull-left">LinkedIn Matrix Analyzer</h1>
      <h2 class="pull-left lead">Overview @DateTime.Today.ToString("dd.MM.yyyy")</h2>
    </div>
    <div class="span6">
      <img class="pull-right" src="../../Content/logo_abrantix.png" />
    </div>
  </div>
</div>
<div class="container">
  <div class="row-fluid well">
    <div class="span5" id="chart_likes"></div>
    <div class="span5" id="chart_comments" ></div>
    <div class="span2">
      <div class="container well span12">
        <h3 class="span12">@Model.person.NetworkStats.properties[0].Value</h3>
        <h4 class="span12">Direct Contacts</h4>
      </div>
      <div class="container well span12">
        <h3 class="span12">@Model.person.NetworkStats.properties[1].Value</h3>
        <h4 class="span12">Second Degree Contacts</h4>
      </div>
    </div>
  </div>
</div>
@helper formatPercentage(int number)
{
    if(number>0) {
        <span style="color:green">+@number%</span>
    }
    else
    {
        <span style="color:red">@number%</span>
    }
}
<div class="accordion container" id="monthes">
    <h1>Timeline:</h1>
    @foreach (LinkedIN.Application.Model.Data month in Model.monthes.Values)
    { 
    <div class="accordion accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#monthes" href="#month-@month.month">
            @month.name (@month.likes likes @formatPercentage(month.likesPercentage) @month.comments comments @formatPercentage(month.commentsPercentage))
        </a>
      </div>
      <div id="month-@month.month" class="accordion-body collapse in @(month.index == 1 ? "" : "")">
        <div class="accordion-inner accordion" id="parent-month-@month.month">
            @foreach (LinkedIN.Application.Model.Data week in Model.weeks.Values)
            {
                if (@month.month == @week.month && week.activities.Count > 0)
                {        
          <div class="accordion-group">
            <div class="accordion-heading"> 
              <a class="accordion-toggle" data-toggle="collapse" data-parent="#parent-month-@month.month" href="#month-@month.month-week-@week.week">
                  @week.name (@week.likes likes @formatPercentage(week.likesPercentage) @week.comments comments @formatPercentage(week.commentsPercentage))
              </a>
            </div>
            <div class="accordion-body collapse in @(week.week == 1 ? "" : "")" id="month-@month.month-week-@week.week">
              <div class="accordion-inner">
                <div class="accordion accordion-group">
                @foreach (LinkedIN.Application.Model.Data activity in week.activities)
                {
                    switch (activity.type)
                    {
                        case 0:                            
                  <div class="">status update @activity.name (@activity.likes likes, @activity.comments comments)</div>
                            break;
                        case 1:
                  <div class=""><a target="_blank" href="@activity.href">group discussion "@activity.name"</a> (@activity.likes likes, @activity.comments comments)</div>
                            break;
                        case 2:
                  <div class="">comment in <a target="_blank" href="@activity.href">group discussion "@activity.name"</a> (@activity.likes likes, @activity.comments comments)</div>
                            break;
                        default:
                            break;
                    }
                  
                }
                </div>
              </div>
            </div>
          </div>
                }
            }
        </div>
      </div>
    </div>
    }
</div>